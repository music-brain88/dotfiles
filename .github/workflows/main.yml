name: build

on:
  push:
    paths-ignore:
      - 'README.md'
      - '.github/PULL_REQUEST_TEMPLATE.md'

jobs:
  ubuntu:
    runs-on: ${{ matrix.os }}
    container:
      image: archlinux:base
      options: --privileged
    #    strategy:
    #      matrix:
    #        os: [ubuntu-22.04]
    #steps:
    #  - uses: actions/checkout@v4
    #  - name: Install required packages
    #    run: |
    #      sudo apt-add-repository ppa:fish-shell/release-3
    #      sudo apt update -y
    #      sudo apt install -y git fish protobuf-compiler
    
    steps:
      - uses: actions/checkout@v4
      - name: Install required packages
        run: |
          pacman -S git gcc make neovim fish openssh pkg-config cmake protobuf xsel

      - name: Setup Rust
        uses: actions-rust-lang/setup-rust-toolchain@v1
        with:
          toolchain: stable
      - name: Run setup script
        run: make install
      - name: Run deploy script
        run: make deploy
